{"ast":null,"code":"import CryptoJS from \"crypto-js\";\nconst encryptKey = '4yJHJpOA5AQgORVuF3VPA3xp8O2HU0Ok5k1NjPk5oWFUhGNBh4UQzoyr/lN6qvv9'; // change later\n\n//store data to session\nexport const setlocalData = (key, data) => {\n  const jsonData = JSON.stringify(data);\n  var encryptJson = encryptData(jsonData, encryptKey);\n  localStorage.setItem(key, encryptJson);\n};\n\n//get data from session\nexport const getlocalData = key => {\n  const jsonData = localStorage.getItem(key);\n  var decryptJson = decryptData(jsonData, encryptKey);\n  // return JSON.parse(jsonData);\n  return decryptJson;\n};\n\n//remove data from session\nexport const removelocalData = key => {\n  localStorage.removeItem(key);\n};\n\n// export const setSessionData = (key, data) => {\n//   const jsonData = JSON.stringify(data);\n//   var encryptJson = encryptData(jsonData, encryptKey);\n//   sessionStorage.setItem(key, encryptJson );\n// };\n\n// export const getSessionData = (key) => {\n//   const jsonData = sessionStorage.getItem(key);\n//   var decryptJson = decryptData(jsonData, encryptKey);\n//   // return JSON.parse(jsonData);\n//   return decryptJson\n// };\n\n// export const removeSessionData = (key) => {\n//   sessionStorage.removeItem(key);\n// };\n\nexport const isSessionSet = key => {\n  const data2 = localStorage.getItem(key);\n  if (data2 !== null) {\n    return true;\n  } else {\n    return false;\n  }\n};\n\n// encryption section\n\nexport const encryptData = (data, key) => {\n  var encryptedData = CryptoJS.AES.encrypt(data, key);\n  return encryptedData.toString();\n};\nexport const decryptData = (data, key) => {\n  var decryptedData = CryptoJS.AES.decrypt(data, key);\n  var jsonData = decryptedData.toString(CryptoJS.enc.Utf8);\n  return JSON.parse(jsonData);\n};\n\n// authentication section\n\nexport const checkVidPermit = U_idFromVid => {\n  const f = isSessionSet('session');\n  var tmp;\n  if (f) {\n    tmp = getlocalData('session');\n  } else {\n    return false;\n  }\n  if (tmp.U_id === U_idFromVid) {\n    return true;\n  } else {\n    return false;\n  }\n};\nexport const getToken = () => {\n  const f = isSessionSet('session');\n  var tmp;\n  if (f) {\n    tmp = getlocalData('token');\n  }\n  return tmp;\n};\nexport const getUser = () => {\n  const f = isSessionSet('session');\n  var tmp;\n  if (f) {\n    tmp = getlocalData('session');\n  }\n  if (tmp) {\n    return tmp.U_id;\n  } else {\n    return '';\n  }\n};\nexport const isAdmin = () => {\n  const f = isSessionSet('session');\n  var tmp;\n  if (f) {\n    tmp = getlocalData('session');\n  } else {\n    return false;\n  }\n  if (tmp.U_type === 'admin') {\n    return true;\n  } else {\n    return false;\n  }\n};","map":{"version":3,"names":["CryptoJS","encryptKey","setlocalData","key","data","jsonData","JSON","stringify","encryptJson","encryptData","localStorage","setItem","getlocalData","getItem","decryptJson","decryptData","removelocalData","removeItem","isSessionSet","data2","encryptedData","AES","encrypt","toString","decryptedData","decrypt","enc","Utf8","parse","checkVidPermit","U_idFromVid","f","tmp","U_id","getToken","getUser","isAdmin","U_type"],"sources":["C:/xampp/htdocs/MSU-Video-Streaming-Project/new/src/components/session.js"],"sourcesContent":["import CryptoJS from \"crypto-js\";\r\n\r\nconst encryptKey = '4yJHJpOA5AQgORVuF3VPA3xp8O2HU0Ok5k1NjPk5oWFUhGNBh4UQzoyr/lN6qvv9'; // change later\r\n\r\n//store data to session\r\nexport const setlocalData = (key, data) => {\r\n  const jsonData = JSON.stringify(data);\r\n  var encryptJson = encryptData(jsonData, encryptKey);\r\n  localStorage.setItem(key, encryptJson );\r\n};\r\n\r\n//get data from session\r\nexport const getlocalData = (key) => {\r\n  const jsonData = localStorage.getItem(key);\r\n  var decryptJson = decryptData(jsonData, encryptKey);\r\n  // return JSON.parse(jsonData);\r\n  return decryptJson\r\n};\r\n\r\n//remove data from session\r\nexport const removelocalData = (key) => {\r\n  localStorage.removeItem(key);\r\n};\r\n\r\n// export const setSessionData = (key, data) => {\r\n//   const jsonData = JSON.stringify(data);\r\n//   var encryptJson = encryptData(jsonData, encryptKey);\r\n//   sessionStorage.setItem(key, encryptJson );\r\n// };\r\n\r\n// export const getSessionData = (key) => {\r\n//   const jsonData = sessionStorage.getItem(key);\r\n//   var decryptJson = decryptData(jsonData, encryptKey);\r\n//   // return JSON.parse(jsonData);\r\n//   return decryptJson\r\n// };\r\n\r\n// export const removeSessionData = (key) => {\r\n//   sessionStorage.removeItem(key);\r\n// };\r\n\r\nexport const isSessionSet = (key) => {\r\n  const data2 = localStorage.getItem(key)\r\n  if (data2 !== null) {\r\n    return true\r\n  }else {\r\n    return false\r\n  }\r\n};\r\n\r\n// encryption section\r\n\r\nexport const encryptData = (data, key) => {\r\n  var encryptedData = CryptoJS.AES.encrypt(data, key);\r\n  return encryptedData.toString();\r\n}\r\n\r\nexport const decryptData = (data, key) => {\r\n  var decryptedData = CryptoJS.AES.decrypt(data, key);\r\n  var jsonData = decryptedData.toString(CryptoJS.enc.Utf8);\r\n  return JSON.parse(jsonData);\r\n}\r\n\r\n// authentication section\r\n\r\nexport const checkVidPermit = (U_idFromVid) => {\r\n  const f = isSessionSet('session')\r\n  var tmp\r\n  if(f) {\r\n    tmp = getlocalData('session')\r\n  }else {\r\n    return false\r\n  }\r\n  if(tmp.U_id === U_idFromVid) {\r\n    return true\r\n  }else {\r\n    return false\r\n  }\r\n}\r\n\r\nexport const getToken = () => {\r\n  const f = isSessionSet('session')\r\n  var tmp\r\n  if(f) {\r\n    tmp = getlocalData('token')\r\n  }\r\n  return tmp\r\n}\r\n\r\nexport const getUser = () => {\r\n  const f = isSessionSet('session')\r\n  var tmp\r\n  if(f) {\r\n    tmp = getlocalData('session')\r\n  }\r\n  if(tmp) {\r\n    return tmp.U_id;\r\n  }else {\r\n    return '';\r\n  }\r\n}\r\n\r\nexport const isAdmin = () => {\r\n  const f = isSessionSet('session')\r\n  var tmp\r\n  if(f) {\r\n    tmp = getlocalData('session')\r\n    \r\n  }else {\r\n    return false\r\n  }\r\n  if(tmp.U_type === 'admin') {\r\n    return true\r\n  }else {\r\n    return false\r\n  }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}